<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Braflix Player</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #000;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Custom CSS for the video container */
        .cinematic-scene {
            position: relative;
            width: 100%;
            height: 100%;
            background-color: #000;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .video-iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* Custom scrubber bar styling for the video timeline */
        .scrubber-track {
            height: 4px;
            background-color: rgba(255, 255, 255, 0.3);
            border-radius: 9999px;
        }

        .scrubber-progress {
            height: 4px;
            width: 30%; /* Simulate 30% progress */
            background-color: #FF0000; /* Red progress indicator */
            border-radius: 9999px;
            position: relative;
        }

        .scrubber-handle {
            position: absolute;
            top: 50%;
            right: 0;
            transform: translate(50%, -50%);
            width: 12px;
            height: 12px;
            background-color: #FF0000;
            border-radius: 50%;
        }

        /* Dropdown specific styling */
        .source-dropdown {
            max-height: 0;
            opacity: 0;
            transform: translateY(-10px);
            transition: max-height 0.3s ease-out, opacity 0.3s ease-out, transform 0.3s ease-out;
            pointer-events: none;
        }
        .source-dropdown.open {
            max-height: 200px; /* Sufficient height to show content */
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
        }

        .tv-inputs {
            display: none;
        }
    </style>
</head>
<body class="bg-black text-white h-screen w-screen flex flex-col">

    <!-- Top Mobile Header/Status Bar Simulation -->
    <header class="w-full p-2 flex items-center justify-end text-xs opacity-80 z-20">
        <!-- Placeholder for time, battery, etc. -->
        <span>12:08</span>
    </header>

    <!-- Main Video Player Container -->
    <main class="flex-grow w-full bg-black flex flex-col relative overflow-hidden">

        <!-- Header Controls (Back button and source selector) -->
        <div class="p-4 flex items-start justify-between z-40 absolute top-0 left-0 right-0">
            <div class="flex items-start space-x-3">
                <!-- Back Arrow icon -->
                <svg class="w-6 h-6 text-white cursor-pointer mt-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" onclick="history.back()"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>

                <!-- Movie Title -->
                <h2 id="movieTitle" class="text-white text-lg font-bold mt-2"></h2>

                <!-- Source Selector Dropdown Container -->
                <div id="source-selector-container" class="relative">
                    <button id="braflix-button" class="bg-gray-800 bg-opacity-70 backdrop-blur-sm rounded-lg px-3 py-1 flex items-center shadow-lg cursor-pointer transition duration-150 ease-in-out hover:bg-gray-700" onclick="toggleDropdown()">
                        <span class="text-white text-sm font-semibold mr-1" id="current-source-name">AutoEmbed Pro</span>
                        <!-- Dropdown indicator (Rotates when open) -->
                        <svg id="dropdown-icon" class="w-4 h-4 text-white transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>

                    <!-- Dropdown Content List -->
                    <div id="source-dropdown" class="source-dropdown absolute left-0 mt-2 w-56 bg-gray-900 rounded-lg shadow-xl overflow-hidden">
                        <ul class="py-1 text-sm text-gray-200">
                            <!-- Selected Source -->
                            <li class="px-4 py-2 bg-red-600 font-bold text-white cursor-default">
                                <span class="mr-2">âœ“</span> AutoEmbed Pro
                            </li>
                            <!-- Other Sources -->
                            <li class="px-4 py-2 hover:bg-gray-700 cursor-pointer" onclick="selectSource('VidSrc Me')">VidSrc Me</li>
                            <li class="px-4 py-2 hover:bg-gray-700 cursor-pointer" onclick="selectSource('EmbedSoap')">EmbedSoap</li>
                            <li class="px-4 py-2 hover:bg-gray-700 cursor-pointer" onclick="selectSource('2Embed')">2Embed</li>
                            <li class="px-4 py-2 hover:bg-gray-700 cursor-pointer" onclick="selectSource('Smashy Stream')">Smashy Stream</li>
                        </ul>
                    </div>
                </div>

                <!-- TV Inputs -->
                <div id="tv-inputs" class="tv-inputs flex space-x-2 mt-2">
                    <input type="number" id="seasonInput" placeholder="S" min="1" class="w-12 px-2 py-1 bg-gray-800 text-white rounded">
                    <input type="number" id="episodeInput" placeholder="E" min="1" class="w-12 px-2 py-1 bg-gray-800 text-white rounded">
                </div>
            </div>

            <!-- Settings/Cast icon placeholder -->
            <div class="text-sm text-white opacity-80 mt-1">
                <svg class="w-6 h-6 cursor-pointer" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.568.568 1.488.948 2.37.948z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
            </div>
        </div>

        <!-- Video Viewport Area -->
        <div class="cinematic-scene">
            <iframe id="video-iframe" class="video-iframe" allowfullscreen></iframe>
        </div>

        <!-- Video Player Controls at the bottom -->
        <div class="p-4 bg-gradient-to-t from-black to-transparent absolute bottom-0 left-0 right-0 z-40">
            <!-- Scrubber/Timeline -->
            <div class="scrubber-track mb-3">
                <div class="scrubber-progress">
                    <div class="scrubber-handle"></div>
                </div>
            </div>

            <div class="flex justify-between items-center text-xs opacity-90">
                <!-- Current Time and Duration -->
                <div class="flex space-x-1">
                    <span class="text-red-500 font-semibold">0:21</span>
                    <span>/</span>
                    <span>1:45:00</span>
                </div>

                <!-- Fullscreen Button -->
                <svg class="w-6 h-6 text-white cursor-pointer" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" onclick="toggleFullscreen()"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-5v4m0-4h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5v-4m0 4h-4m4 0l-5-5"></path></svg>
            </div>
        </div>

    </main>

    <!-- Footer/Mobile Navigation Bar Simulation -->
    <footer class="w-full h-14 bg-black flex items-center justify-around border-t border-gray-900 z-30">
        <!-- Home/Recents/Back buttons -->
        <div class="w-6 h-6 border-2 border-white rounded-sm opacity-80"></div>
        <div class="w-8 h-8 border-2 border-white rounded-full opacity-80"></div>
        <div class="w-6 h-6 border-2 border-white rounded-sm opacity-80"></div>
    </footer>

    <script>
        const dropdown = document.getElementById('source-dropdown');
        const dropdownIcon = document.getElementById('dropdown-icon');
        const currentSourceName = document.getElementById('current-source-name');
        const iframe = document.getElementById('video-iframe');
        const tvInputs = document.getElementById('tv-inputs');

        let currentProvider = 'https://autoembed.pro/embed/';
        let type = '';
        let id = '';
        let season = 1;
        let episode = 1;

        const providers = {
            'AutoEmbed Pro': 'https://autoembed.pro/embed/',
            'VidSrc Me': 'https://vidsrc.me/embed/',
            'EmbedSoap': 'https://embedsoap.com/embed/',
            '2Embed': 'https://www.2embed.cc/embed/',
            'Smashy Stream': 'https://player.smashy.stream/'
        };

        function getParams() {
            const urlParams = new URLSearchParams(window.location.search);
            type = urlParams.get('type');
            id = urlParams.get('id');
            const title = urlParams.get('title');
            season = parseInt(urlParams.get('season')) || 1;
            episode = parseInt(urlParams.get('episode')) || 1;
            document.getElementById('movieTitle').textContent = title || 'Movie Player';
            if (type === 'tv') {
                tvInputs.style.display = 'flex';
                document.getElementById('seasonInput').value = season;
                document.getElementById('episodeInput').value = episode;
            }
            loadVideo();
        }

        function loadVideo() {
            let url = currentProvider;
            if (type === 'movie') {
                url += `movie/${id}`;
            } else if (type === 'tv') {
                url += `tv/${id}/${season}/${episode}`;
            }
            iframe.src = url;
        }

        /**
         * Toggles the visibility of the source provider dropdown menu.
         */
        function toggleDropdown() {
            dropdown.classList.toggle('open');
            if (dropdown.classList.contains('open')) {
                dropdownIcon.style.transform = 'rotate(180deg)';
            } else {
                dropdownIcon.style.transform = 'rotate(0deg)';
            }
        }

        /**
         * Selects a provider from the list and updates the display name.
         * @param {string} sourceName - The name of the selected video source.
         */
        function selectSource(sourceName) {
            currentProvider = providers[sourceName];
            currentSourceName.textContent = sourceName;
            toggleDropdown();
            loadVideo();
        }

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }

        document.getElementById('seasonInput').addEventListener('change', (e) => {
            season = parseInt(e.target.value) || 1;
            loadVideo();
        });

        document.getElementById('episodeInput').addEventListener('change', (e) => {
            episode = parseInt(e.target.value) || 1;
            loadVideo();
        });

        /**
         * Closes the dropdown when the user clicks outside of the selector area.
         */
        document.addEventListener('click', function(event) {
            const container = document.getElementById('source-selector-container');
            const isClickInside = container.contains(event.target);

            if (!isClickInside && dropdown.classList.contains('open')) {
                toggleDropdown();
            }
        });

        // Load on page load
        getParams();
    </script>
</body>
</html>
