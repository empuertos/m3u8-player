<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Philippines Vertical Weather Map</title>
<style>
body {
    font-family: Arial, sans-serif;
    background-color: #1a1a1a;
    color: #fff;
    margin: 0;
    padding: 0;
    overflow-x: hidden;
}
#map-container {
    position: relative;
    width: 100%;
    max-width: 400px;
    margin: 20px auto;
    height: 100vh;
}
.city {
    position: absolute;
    width: 90%;
    left: 5%;
    padding: 10px;
    display: flex;
    align-items: center;
    border-radius: 10px;
    background-color: rgba(51,51,51,0.9);
    box-shadow: 0 2px 5px rgba(0,0,0,0.5);
    overflow: hidden;
}
.marker {
    position: absolute;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    top: -10px;
    left: -10px;
    border: 2px solid #fff;
    z-index: 0;
}
.city img {
    width: 40px;
    height: 40px;
    margin-right: 10px;
    z-index: 2;
    position: relative;
}
.city-info {
    display: flex;
    flex-direction: column;
    z-index: 2;
    position: relative;
}
.city-name { font-weight: bold; color: #ffd700; }
.temp { color: #67e8f9; }
.condition { color: #ccc; font-size: 0.9em; }
.overlay { position: absolute; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:1; }
.drop {
    position: absolute;
    width: 2px; height: 10px;
    background: #67e8f9; opacity: 0.6;
    animation: fall 1s linear infinite;
}
@keyframes fall { 0%{transform:translateY(-10px);}100%{transform:translateY(100%);} }
.cloud {
    position: absolute; width: 60px; height: 30px;
    background: rgba(200,200,200,0.3);
    border-radius: 50%;
    animation: cloudMove 6s linear infinite;
}
@keyframes cloudMove { 0%{left:-70px;}100%{left:100%;} }
.sun-ray {
    position: absolute; width:6px; height:20px;
    background: #ffd700; opacity:0.7;
    top:5px; left:50%; transform-origin: bottom center;
    animation: spin 1s linear infinite;
}
@keyframes spin { 0%{transform:rotate(0deg) translateX(-50%)} 100%{transform:rotate(360deg) translateX(-50%)} }
</style>
</head>
<body>
<div id="map-container"></div>
<script>
const apiKey = "2bfa044af082bab4c373f17dc0b530da";
const cities = [
    { name: "Manila", query: "Manila,PH", top: "5%", color:"#ff4d4d" },
    { name: "Talisay City Cebu", query: "Talisay,Cebu,PH", top: "18%", color:"#4dffff" },
    { name: "Cebu City", query: "Cebu City,PH", top: "31%", color:"#4dff4d" },
    { name: "Cagayan de Oro", query: "Cagayan de Oro,PH", top: "44%", color:"#ffff4d" },
    { name: "Zamboanga", query: "Zamboanga,PH", top: "57%", color:"#ff4dff" },
    { name: "Davao City", query: "Davao City,PH", top: "70%", color:"#ffb84d" }
];

function createRain(cityDiv, count=20){
    const overlay = document.createElement('div'); overlay.className='overlay';
    for(let i=0;i<count;i++){
        const drop=document.createElement('div');
        drop.className='drop';
        drop.style.left=Math.random()*100+'%';
        drop.style.animationDelay=Math.random()+'s';
        overlay.appendChild(drop);
    }
    cityDiv.appendChild(overlay);
}

function createClouds(cityDiv,count=3){
    const overlay=document.createElement('div'); overlay.className='overlay';
    for(let i=0;i<count;i++){
        const cloud=document.createElement('div');
        cloud.className='cloud';
        cloud.style.top=Math.random()*20+'px';
        cloud.style.animationDuration=(4+Math.random()*4)+'s';
        overlay.appendChild(cloud);
    }
    cityDiv.appendChild(overlay);
}

function createSunRays(cityDiv,count=8){
    const overlay=document.createElement('div'); overlay.className='overlay';
    for(let i=0;i<count;i++){
        const ray=document.createElement('div');
        ray.className='sun-ray';
        ray.style.transform=`rotate(${i*45}deg) translateX(-50%)`;
        overlay.appendChild(ray);
    }
    cityDiv.appendChild(overlay);
}

async function fetchWeather(){
    const container=document.getElementById("map-container");
    container.innerHTML="";
    for(let city of cities){
        const cityDiv=document.createElement('div');
        cityDiv.className='city'; cityDiv.style.top=city.top;
        const marker=document.createElement('div');
        marker.className='marker'; marker.style.backgroundColor=city.color;
        cityDiv.appendChild(marker);

        try{
            const url=`https://api.openweathermap.org/data/2.5/weather?q=${city.query}&appid=${apiKey}&units=metric`;
            const res=await fetch(url);
            const data=await res.json();
            const weatherMain=data.weather[0].main.toLowerCase();

            cityDiv.innerHTML+=`
                <img src="https://openweathermap.org/img/wn/${data.weather[0].icon}@2x.png" alt="weather icon">
                <div class="city-info">
                    <div class="city-name">${city.name}</div>
                    <div class="temp">${data.main.temp.toFixed(1)}Â°C</div>
                    <div class="condition"></div>
                </div>
            `;

            let conditionText="";
            if(weatherMain.includes("rain")){ conditionText="Raining"; createRain(cityDiv,25); }
            else if(weatherMain.includes("cloud")){ conditionText="Cloudy"; createClouds(cityDiv,3); }
            else if(weatherMain.includes("clear")){ conditionText="Sunny"; createSunRays(cityDiv,8); }
            else{ conditionText=data.weather[0].description; }

            cityDiv.querySelector('.condition').textContent=conditionText;

        } catch(error){
            cityDiv.innerHTML+=`
                <div class="city-info">
                    <div class="city-name">${city.name}</div>
                    <div class="condition">Data unavailable</div>
                </div>
            `;
        }

        container.appendChild(cityDiv);
    }
}

// Initial fetch and repeat every 10 seconds
fetchWeather();
setInterval(fetchWeather,10000);
</script>
</body>
</html>
