<script>
const api = "https://noisy-frog-a9ab.st3v3.workers.dev"; 
const target = "https://vidrock.net/movie/1038392";       

async function loadVidrock() {
  try {
    const res = await fetch(`${api}/?url=${encodeURIComponent(target)}`);
    const data = await res.json();
    console.log("Worker response:", data);

    if (data.stream) {
      videojs("player", {
        sources: [{ src: data.stream, type: "application/x-mpegURL" }]
      });
    } else {
      // escape HTML so it shows as text
      const safe = (data.preview || data.error || "")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;");
      document.body.innerHTML += `
        <pre style="white-space: pre-wrap; max-height: 400px; overflow:auto; background:#eee; padding:10px; font-size:12px;">
${safe}
        </pre>
      `;
    }
  } catch (e) {
    document.body.innerHTML += `<p>‚ùå Fetch failed: ${e.message}</p>`;
  }
}

loadVidrock();
</script>
